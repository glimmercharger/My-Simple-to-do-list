<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple To Do List</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(120deg, #f6d365 0%, #fda085 100%);
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
    .container {
      background: #fff;
      padding: 32px 24px;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.12);
      margin-top: 60px;
      width: 350px;
      max-width: 90vw;
    }
    h2 {
      text-align: center;
      color: #f76b1c;
      margin-bottom: 24px;
    }
    #new-task {
      width: 70%;
      padding: 8px 12px;
      border: 1px solid #f76b1c;
      border-radius: 8px;
      font-size: 16px;
      outline: none;
      margin-right: 8px;
      transition: border-color 0.2s;
    }
    #new-task:focus {
      border-color: #fda085;
    }
    button {
      background: #f76b1c;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 8px 16px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.2s;
    }
    button:hover {
      background: #fda085;
    }
    #todo-list {
      list-style: none;
      padding: 0;
      margin-top: 20px;
    }
    #todo-list li {
      background: #f9f9f9;
      margin-bottom: 12px;
      padding: 10px 14px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      font-size: 16px;
      transition: box-shadow 0.2s, transform 0.4s;
      animation: fadeUp 0.7s;
    }
    #todo-list li.added {
      animation: fadeUp 0.7s;
    }
    #todo-list li.fadeIn {
      animation: fadeUp 0.7s;
    }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes bounceIn {
      0% { transform: scale(0.7); }
      60% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    @keyframes fadeOut {
      to { opacity: 0; transform: translateX(100px); }
    }
    .task-done {
      text-decoration: line-through;
      color: #aaa;
      transition: color 0.4s, text-decoration 0.4s;
    }
    .checkbox {
      width: 18px;
      height: 18px;
      accent-color: #f76b1c;
      margin-right: 12px;
      cursor: pointer;
      transition: transform 0.3s;
    }
    .confetti {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 9999;
    }
  </style>
</head>
<body>
    <canvas id="confetti-canvas" class="confetti"></canvas>
    <div class="container">
      <h2>To Do List</h2>
      <div style="display: flex; align-items: center;">
        <input id="new-task" type="text" placeholder="Add a new task">
        <button onclick="addTask()">Add</button>
      </div>
      <ul id="todo-list"></ul>
      <button id="clear-finished" onclick="clearFinishedTasks()" style="width:100%;margin-top:18px;display:none;">Clear Finished Tasks</button>
      <div id="easter-egg" style="text-align:center;font-size:12px;color:#f76b1c;opacity:0.2;margin-top:18px;user-select:none;">Made by Will K</div>
    </div>

  <script>
    function addTask() {
      const input = document.getElementById('new-task');
      const task = input.value.trim();
      if (task) {
        const li = document.createElement('li');
        li.classList.add('added');
        li.addEventListener('animationend', function handler(e) {
          if (e.animationName === 'fadeUp') {
            li.classList.remove('added');
            li.removeEventListener('animationend', handler);
          }
        });
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'checkbox';
        const span = document.createElement('span');
        span.textContent = task;
        span.style.marginLeft = '0';
        checkbox.onclick = function() {
          if (checkbox.checked) {
            span.classList.add('task-done');
            checkbox.style.transform = 'scale(1.3)';
            setTimeout(() => { checkbox.style.transform = 'scale(1)'; }, 300);
          } else {
            span.classList.remove('task-done');
            checkbox.style.transform = 'scale(1)';
          }
          saveTasks();
          checkAllFinished();
        };
        li.appendChild(checkbox);
        li.appendChild(span);
        document.getElementById('todo-list').appendChild(li);
        input.value = '';
        saveTasks();
        checkAllFinished();
      }
    }

    function saveTasks() {
      const list = document.getElementById('todo-list');
      const tasks = Array.from(list.children).map(li => {
        return {
          text: li.querySelector('span').textContent,
          done: li.querySelector('.checkbox').checked
        };
      });
      localStorage.setItem('todoList', JSON.stringify(tasks));
    }

    function loadTasks() {
      const tasks = JSON.parse(localStorage.getItem('todoList') || '[]');
      const list = document.getElementById('todo-list');
      list.innerHTML = '';
      tasks.forEach(task => {
        const li = document.createElement('li');
        li.classList.add('fadeIn');
        li.addEventListener('animationend', function handler(e) {
          if (e.animationName === 'fadeUp') {
            li.classList.remove('fadeIn');
            li.removeEventListener('animationend', handler);
          }
        });
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'checkbox';
        const span = document.createElement('span');
        span.textContent = task.text;
        span.style.marginLeft = '0';
        if (task.done) {
          checkbox.checked = true;
          span.classList.add('task-done');
        }
        checkbox.onclick = function() {
          if (checkbox.checked) {
            span.classList.add('task-done');
            checkbox.style.transform = 'scale(1.3)';
            setTimeout(() => { checkbox.style.transform = 'scale(1)'; }, 300);
          } else {
            span.classList.remove('task-done');
            checkbox.style.transform = 'scale(1)';
          }
          saveTasks();
          checkAllFinished();
        };
        li.appendChild(checkbox);
        li.appendChild(span);
        list.appendChild(li);
      });
      checkAllFinished();
    }

    function checkAllFinished() {
      const list = document.getElementById('todo-list');
      const items = list.querySelectorAll('li');
      const allDone = Array.from(items).length > 0 && Array.from(items).every(li => li.querySelector('.checkbox').checked);
      document.getElementById('clear-finished').style.display = allDone ? 'block' : 'none';
      if (allDone) {
        launchConfetti();
      }
    }

    function clearFinishedTasks() {
      localStorage.removeItem('todoList');
      const list = document.getElementById('todo-list');
      list.innerHTML = '';
      document.getElementById('clear-finished').style.display = 'none';
    }

    window.onload = loadTasks;

    // Improved confetti animation with fade out at bottom
    function launchConfetti() {
      const canvas = document.getElementById('confetti-canvas');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      let confetti = [];
      for (let i = 0; i < 120; i++) {
        confetti.push({
          x: Math.random() * canvas.width,
          y: Math.random() * -canvas.height,
          r: Math.random() * 8 + 4,
          d: Math.random() * 120 + 40,
          color: `hsl(${Math.random()*360},90%,60%)`,
          tilt: Math.random() * 10 - 5,
          vy: Math.random() * 2 + 2,
          vx: Math.random() * 2 - 1,
          alpha: 1,
          faded: false
        });
      }
      let frame = 0;
      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        confetti.forEach(c => {
          ctx.save();
          ctx.globalAlpha = c.alpha;
          ctx.translate(c.x, c.y);
          ctx.rotate(c.tilt * Math.PI / 180);
          ctx.beginPath();
          ctx.arc(0, 0, c.r, 0, 2 * Math.PI);
          ctx.fillStyle = c.color;
          ctx.fill();
          ctx.restore();
        });
        update();
        frame++;
        if (frame < 120 || confetti.some(c => c.alpha > 0.01)) {
          requestAnimationFrame(draw);
        } else {
          setTimeout(() => ctx.clearRect(0, 0, canvas.width, canvas.height), 800);
        }
      }
      function update() {
        confetti.forEach(c => {
          if (!c.faded) {
            c.y += c.vy;
            c.x += c.vx;
            if (c.y > canvas.height - 10) {
              c.faded = true;
            }
          }
          if (c.faded && c.alpha > 0) {
            c.alpha -= 0.04;
            if (c.alpha < 0) c.alpha = 0;
          }
        });
      }
      draw();
    }
  </script>
</body>
</html>